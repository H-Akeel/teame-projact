<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ุชูููุฏ ุฌุฏูู</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link rel="stylesheet" href="index.css">
    <link rel="icon" type="..//photo/png" href="..//Photo/t ~.png">


</head>
<body>

  <div class="logo-center">
  <img src="..//Photo/t ~ TIME.png" alt="ุงูุดุนุงุฑ" class="logo-img">
</div>


  <h2>ุฅุฏุฎุงู ุงูุจูุงูุงุช</h2>
  <label for="">ูุณู ุงูุญูุงูุฉ</label>
  <input type="text" id="tawn" placeholder="ูุณู ุงูุญูุงูุฉ"><br>

  <label for="">ุงููุญุงูุธุฉ</label>
  <input type="text" id="city" placeholder="ุงููุญุงูุธุฉ"><br>

  <label for="">ุชุงุฑูุฎ ููู ุงูุฌุฏูู</label>
  <input type="date" id="table_date_input" placeholder="๐ ุงูุชุงุฑูุฎ ููู ุงูุฌุฏูู"><br>

  <label for="">ุชุงุฑูุฎ ุงูุงุณุชูุงู ุฏุงุฎู ุงูุฌุฏูู</label>
  <input type="date" id="receive_date_table" placeholder="๐ ุชุงุฑูุฎ ุงูุงุณุชูุงู ุฏุงุฎู ุงูุฌุฏูู"><br>

  <label for="">ุงุณู ุงููุณุชูู</label>
  <input type="text" id="cost_name" placeholder="ุงุณู ุงููุณุชูู"><br>

  <label for="">ุงุณู ุงูุฃู</label>
  <input type="text" id="cost_mother_name" placeholder="ุงุณู ุงูุฃู"><br>

  <button onclick="generateTable()">๐ ุชูููุฏ ุงูุฌุฏูู</button><br>
  <button onclick="downloadPDF()">๐ ุชุญููู PDF</button><br>


  <!-- โ ูุญุชูู ุงูุทุจุงุนุฉ -->
  <div id="pdf_container">
    <div class="acsubt_done">
      <div class="header-line">
        <h2 class="date" id="date_display">---</h2>
        <h1 class="done">ุชูุช&nbsp;ุงูููุงููุฉ</h1>
        <h2 class="time">(7)</h2>
      </div>
    </div>
    <div id="result_table"></div>
  </div>

  <script>
    let pyodideReady = false;
    let pyodide;

    async function loadPy() {
      pyodide = await loadPyodide();
      pyodideReady = true;
    }
    loadPy();

    async function generateTable() {
      if (!pyodideReady) return alert("ุฌุงุฑู ุชุญููู ุจุงูุซูู...");

      const tawn = document.getElementById("tawn").value;
      const city = document.getElementById("city").value;
      const dateAboveTable = document.getElementById("table_date_input").value;
      const dateInsideTable = document.getElementById("receive_date_table").value;
      const cname = document.getElementById("cost_name").value;
      const cmother = document.getElementById("cost_mother_name").value;

      document.getElementById("date_display").innerText = dateAboveTable || "---";

      const pyCode = `
import random
import locale
locale.setlocale(locale.LC_COLLATE, 'ar_SA.UTF-8')

female_names = ${JSON.stringify([
  "ุขูุฉ", "ุฃุณูู", "ุฃูููุฉ", "ุณููุฉ", "ุฅุณุฑุงุก", "ุฅููุงู", "ุฅููุงุณ", "ุฒููุจ", "ูุฑูู", "ูููู", "ูุฌูุงุก", "ููุฏ", "ูููุงุก", "ูุงุณููู",
  "ุดูุฏ", "ุฑุญูุฉ", "ููุฑ", "ุฌูู", "ุณุงุฑุฉ", "ุฑุงููุง", "ุฑุบุฏ", "ุฌูููุฉ", "ุจุณูุฉ", "ูููุง", "ุฑูุจู", "ูุฑุญ", "ุฎููุฏ", "ุฏุนุงุก", "ูุจุฉ",
  "ุนุจูุฑ", "ููู", "ุชุณููู", "ุจุชูู", "ุญูุง", "ุณูุฏุณ", "ุดุฐู", "ุบุงุฏุฉ", "ููุฑุง", "ุฑูุฏ", "ุฏููุง", "ุฃุฑูุฌ", "ูุณุฑูู", "ุณููู", "ุถุญู", "ูุงุฑุง",
  "ููุงุฏ", "ุฃูู", "ุณููู", "ุฑูู", "ููุงุก", "ูู", "ุนูุง", "ุฑูุงู", "ุนูุฑุงุก", "ููู", "ุฑููููุฉ"
])}

male_names = ${JSON.stringify([
  "ุฃุญูุฏ", "ูุญูุฏ", "ุนูู", "ุญุณู", "ุญุณูู", "ุนูุฑ", "ุจูุงู", "ููุตู", "ููุฏ", "ูุตุทูู", "ูุฑูุงู", "ูุงุดู", "ูุดุงู", "ูุนูุงู",
  "ุทุงุฑู", "ุณุงูู", "ุฒูุงุฏ", "ุฃูุณ", "ูุนุงุฐ", "ูุงุฑุณ", "ุจุงุณู", "ููุฑ", "ุฑุงูู", "ุณูู", "ูุงูู", "ุฎุงูุฏ", "ุฌูุงู", "ุนุฏูุงู", "ุฅุจุฑุงููู",
  "ุฅูุงุฏ", "ูุงุฏุฑ", "ูุงุฆู", "ุนุจุฏุงููู", "ุฃููู", "ูุงุฒู", "ุณูููุงู", "ูุญูู", "ุนุจุฏุงูุฑุญูู", "ุนุจุฏุงููุฑูู", "ุฃูุณ", "ุนูุฑู", "ุจุฑุงุก", "ุชูู",
  "ูุฒุงุฑ", "ุญุฐููุฉ", "ูููุฏ", "ููุณ", "ุดุงุฏู", "ูุฒู", "ูููุฏ", "ุณุงูุฑ"
])}


def gen_male_name():
    nbsp = "\u00A0"
    return nbsp.join(random.sample(male_names, 3))

def gen_female_name():
    nbsp = "\u00A0"
    first = random.choice(female_names)
    last_two = random.sample(male_names, 2)
    return nbsp.join([first] + last_two)


table = []
for i in range(30):
    table.append([
        "${tawn}",
        "${city}",
        gen_male_name(),
        gen_female_name(),
        "${dateInsideTable}"
    ])

nbsp = "\u00A0"
cname_fixed = "${cname}".replace(" ", nbsp)
cmother_fixed = "${cmother}".replace(" ", nbsp)
table.append(["${tawn}".replace(" ", nbsp), "${city}".replace(" ", nbsp), cname_fixed, cmother_fixed, "${dateInsideTable}"])
table.sort(key=lambda row: locale.strxfrm(row[2]))

header = ["ูุณู&nbsp;ุงูุญูุงูุฉ", "ุงููุญุงูุธุฉ", "ุงูุงุณู", "ุงุณู&nbsp;ุงูุฃู", "ุชุงุฑูุฎ&nbsp;ุงูุงุณุชูุงู"]

html = "<table><tr>" + "".join(f"<th>{h}</th>" for h in header) + "</tr>"
for row in table:
    html += "<tr>" + "".join(f"<td>{cell}</td>" for cell in row) + "</tr>"
html += "</table>"
html
      `;

      const result = await pyodide.runPythonAsync(pyCode);
      document.getElementById("result_table").innerHTML = result;
    }

    function downloadPDF() {
      const element = document.getElementById("pdf_container");
      const opt = {
        margin: [0, 0, 0, 0],  // โ ุจุฏูู ููุงูุด ููุงุฆูุงู
        filename: 'ุฌุฏูู_ุงูุฃุณูุงุก.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'cm', format: 'a4', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    }
    function downloadAsJPG() {
  const element = document.getElementById("pdf_container");

  html2canvas(element, {
    scale: 3, // ุฌูุฏุฉ ุฃุนูู
    useCORS: true
  }).then(canvas => {
    const link = document.createElement('a');
    link.download = 'ุงูุฌุฏูู.jpg';
    link.href = canvas.toDataURL('image/jpeg', 1.0); // ุฌูุฏุฉ 100%
    link.click();
  });
}

  </script>
  

</body>
</html>
